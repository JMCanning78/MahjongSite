{% extends "template.html" %}
{% block title %} - {{ user }}'s Game History{% endblock %}
{% block head %}
		<link href="{{ url_for('static', filename="css/history.css") }}" type="text/css" rel="stylesheet" />
{% endblock %}
{% block content %}
	{% if not error %}
		<h1>{{ user }}'s Game History</h1>
		<br />
		<p>Click any player to see his or her stats</p>
		{% set lastdate = None %}
		<table class="game">
			<thead>
				<tr>
					<th>Rank</th>
					<th>Name</th>
					<th>Raw Score</th>
					<th>Score</th>
					<th>Chombos</th>
				</tr>
			</thead>
		</table>
		{% for game in games %}
			{% if lastdate != game['date'] %}
				<h3 class="date">{{ game['date'] }}</h3>
				{% set lastdate = game['date'] %}
			{% endif %}
		<table class="game">
			{% if 'admin' in session and session['admin'] %}
			<thead>
				<th />
				<th>Game #{{ game['id'] }}</th>
				<th><a href="/admin/delete/{{ game['id'] }}">Delete</a></th>
				<th><a href="/admin/edit/{{ game['id'] }}">Edit</a></th>
				<th />
			</thead>
			{% endif %}
			<tbody>
				{% for score in game['scores'].items() %}
				<tr>
					<td>{{ score [0] }}</td>
					<td><a href="/playerstats/{{ score [1][0] }}">{{ score [1][0] }}</a></td>
					<td>{{ score[1][1] }}K{% if score[1][3] != 0 %} (-{{ score[1][3] * 8 }}K){% endif %}</td>
					<td>{{ score[1][2] }}</td>
					<td>{{ score[1][3] }}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
		{% endfor %}
		{% if prev %}
			<a href="/playerhistory/{{ player }}/{{ prev }}">«</a>
		{% endif %}
		{% for page in pages %}
			{% if curpage == page %}
				<span id="currentpage">{{ page }}</span>
			{% else %}
				<a href="/playerhistory/{{ player }}/{{ page }}">{{ page }}</a>
			{% endif %}
		{% endfor %}
		{% if nex %}
			<a href="/playerhistory/{{ player }}/{{ nex }}">»</a>
		{% endif %}
	{% else %}
		<h1 id="message">{{ error }}</h1>
	{% endif %}
{% endblock %}
